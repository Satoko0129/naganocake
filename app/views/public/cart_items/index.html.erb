<div class="container">
  <div class="row">
    <div class="col-sm-8 px-sm-0 offset-sm-1">
      <h3 class="my-5"><strong>ショッピングカート</strong></h3>
      <div class="col-xs-11" id="no_cart">
        <% if @cart_items.present? %>
        <!--presentメソッドの基本形は、(変数）.present?-->
        <!--存在を確認したい変数に対して、カンマとpresent、そして最後にクエスチョンマークを付ける。-->
        <%= link_to "カートを空にする",cart_items_path, method: :delete, data: {confirm: 'カートを空にしてよろしいですか？'}, class: "btn btn-danger" %>
        <% end %>
      <table class="table table-hover table-bordered">
        <tr>
          <th>商品名</th>
          <th>単価(税込)</th>
          <th>数量</th>
          <th>小計</th>
          <th></th>
        </tr>
        <% @cart_items.each do |i| %>
          <tr id="cart-<%= i.id %>">
            <th> <!--商品名-->
              <%= attachment_image_tag i.item, :image, size: "55x43", fallback: "noimage.jpg" %>
              <%= i.item.name %>
            </th>

            <th> <!--単価-->
              <%= i.item.tax_in_price.to_s(:delimited, delimiter: ',') %>
            </th>

            <th><!--数量-->
              <%= form_with model:i, url: cart_items_path(i), method: :patch, remote: true do |f| %>
              <%= f.number_field :count, size: 10, min: 1 %>
              <%= f.submit "変更", class: "btn btn-success" %>
              <% end %>
            </th>

            <th> <!--小計-->
              <%= subtotal(i).to_s(:delimited, delimiter: ',' ) %>
            </th>

            <th>
              <%= link_to "削除する", cart_item_path(i), method: :delete, remote: true, data: {confirm: "{i.item.name}を削除してよろしいですか？", class: "btn btn-danger"} %>
            </th>
          </tr>
          <% end %>
          <!--aaaa-->
      </table>

      <%= link_to "買い物を続ける", root_path, class: "btn btn-info" %>

      <table class="table table-bordered text-right">
        <tr>
          <td>合計金額</td>
          <td></td>
        </tr>
      </table>
      </div>
    </div>
  </div>
</div>